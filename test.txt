it('validateWorksheet(): should flag invalid length when accoutColumnHeader exceeds 16 chars', () => {
  component.accoutColumnHeader = 'Account';
  component.miscAmountColumnHeader = 'Amount';
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{ Account: '12345678901234567' }]; // 17 chars

  component.validateWorksheet(worksheet);

  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith('Account field exceed max length of 16 characters; please update and reupload..');
});

it('validateWorksheet(): should flag missing required account column', () => {
  component.accoutColumnHeader = 'Account';
  component.isMissingRequiredField = false;
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{}]; // missing key

  component.validateWorksheet(worksheet);

  expect(component.isMissingRequiredField).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith('Account is missing on the excel sheet. This is a required field; please update and reupload.');
});

it('validateWorksheet(): should flag invalid misc amount (non-numeric)', () => {
  component.miscAmountColumnHeader = 'Amount';
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{ Amount: 'abc' }]; // not a number

  component.validateWorksheet(worksheet);

  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith('Amount field input must be a numeric value; please update and reupload..');
});

it('validateWorksheet(): should flag missing required misc amount column', () => {
  component.miscAmountColumnHeader = 'Amount';
  component.isMissingRequiredField = false;
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{}];

  component.validateWorksheet(worksheet);

  expect(component.isMissingRequiredField).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith('Amount is missing on the excel sheet. This is a required field; please update and reupload.');
});