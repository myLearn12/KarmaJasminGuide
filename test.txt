it('canProcessRecord(true): should hide confirmModal and call processRecord', () => {
  (component as any).confirmModal = { hide: jasmine.createSpy('hide') };
  const processSpy = spyOn(component as any, 'processRecord').and.callFake(() => {});

  component.canProcessRecord(true);

  expect((component as any).confirmModal.hide).toHaveBeenCalled();
  expect(processSpy).toHaveBeenCalled();
});

it('canProcessRecord(false): should hide confirmModal but not call processRecord', () => {
  (component as any).confirmModal = { hide: jasmine.createSpy('hide') };
  const processSpy = spyOn(component as any, 'processRecord').and.callFake(() => {});

  component.canProcessRecord(false);

  expect((component as any).confirmModal.hide).toHaveBeenCalled();
  expect(processSpy).not.toHaveBeenCalled();
});

it('uploadXcelFile(): should show confirmModal when selected date is today', () => {
  const showSpy = jasmine.createSpy('show');
  (component as any).confirmModal = { show: showSpy };
  (component as any).selectedMonthEndDate = '2025-11-12';
  (component as any).utils = { isTodaysDate: () => true };
  spyOn(component as any, 'ValidateFormControls').and.returnValue(false);

  component.uploadXcelFile();

  expect((component as any).actionMessage)
    .toContain('Date selected is Today');
  expect(showSpy).toHaveBeenCalled();
});

it('uploadXcelFile(): should call processRecord when date is not today', () => {
  (component as any).utils = { isTodaysDate: () => false };
  spyOn(component as any, 'ValidateFormControls').and.returnValue(false);
  const processSpy = spyOn(component as any, 'processRecord').and.callFake(() => {});

  component.uploadXcelFile();

  expect(processSpy).toHaveBeenCalled();
});