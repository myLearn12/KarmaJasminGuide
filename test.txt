it('should mark invalid char length when account number exceeds 16 characters', () => {
  component.accoutColumnHeader = 'AccountNo';
  component.cashAmountColumnHeader = 'CashAmount';
  component.paidThruDateColumnHeader = 'PaidDate';
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  spyOn(component, 'fileuploadError');

  const worksheet = [{ AccountNo: '12345678901234567' }]; // 17 chars

  component.validateWorksheet(worksheet);

  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'AccountNo field exceed max length of 16 characters; please update and reupload..'
  );
});

it('should mark missing account column when AccountNo is undefined', () => {
  component.accoutColumnHeader = 'AccountNo';
  component.cashAmountColumnHeader = 'CashAmount';
  component.paidThruDateColumnHeader = 'PaidDate';
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  spyOn(component, 'fileuploadError');

  const worksheet = [{ SomethingElse: 'value' }];

  component.validateWorksheet(worksheet);

  expect(component.isMissingRequiredField).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'AccountNo is missing on the excel sheet. This is a required field; please update and reupload.'
  );
});

it('should mark invalid char length when CashAmount is not numeric', () => {
  component.accoutColumnHeader = 'AccountNo';
  component.cashAmountColumnHeader = 'CashAmount';
  component.paidThruDateColumnHeader = 'PaidDate';
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  spyOn(component, 'fileuploadError');

  const worksheet = [{ AccountNo: '123', CashAmount: 'NaNValue' }];

  component.validateWorksheet(worksheet);

  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'CashAmount field input must be a numeric value; please update and reupload..'
  );
});

it('should mark missing CashAmount when field is undefined', () => {
  component.accoutColumnHeader = 'AccountNo';
  component.cashAmountColumnHeader = 'CashAmount';
  component.paidThruDateColumnHeader = 'PaidDate';
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  spyOn(component, 'fileuploadError');

  const worksheet = [{ AccountNo: '123' }];

  component.validateWorksheet(worksheet);

  expect(component.isMissingRequiredField).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'CashAmount is missing on the excel sheet. This is a required field; please update and reupload.'
  );
});

it('should mark invalid char length when PaidDate has invalid format', () => {
  component.accoutColumnHeader = 'AccountNo';
  component.cashAmountColumnHeader = 'CashAmount';
  component.paidThruDateColumnHeader = 'PaidDate';
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  spyOn(component, 'fileuploadError');
  component.utils = { isValidDateFormat: () => false } as any;

  const worksheet = [{ AccountNo: '123', CashAmount: 10, PaidDate: '99/99/9999' }];

  component.validateWorksheet(worksheet);

  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'PaidDate field input must be a Date value (Format: YYYY-MM-DD); please update and reupload..'
  );
});