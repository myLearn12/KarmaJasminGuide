it('checkFile(): when worksheet has valid rows and no validation errors -> should set isfileuploaded true and clear errorBlockMessage', () => {
  // Arrange
  component.sheetName = 'Sheet1';
  component.maxUploadRowCount = 100;

  // mock the worksheet with 1 valid row
  const worksheetMock = {
    Sheet1: [{ some: 'data' }]
  };

  // ensure flags start off wrong
  component.isInvalidCharLength = false;
  component.isMissingRequiredField = false;
  component.isfileuploaded = false;
  component.errorBlockMessage = 'previous error';

  // stub out validateWorksheet to skip its internal logic
  spyOn(component as any, 'validateWorksheet').and.callFake(() => {});

  // Act
  component.checkFile(worksheetMock);

  // Assert
  expect(component.isfileuploaded).toBeTrue();
  expect(component.errorBlockMessage).toBeNull();
});