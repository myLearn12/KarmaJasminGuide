// error branch
it('LoadDefaultComboBox(): error -> calls displayServiceErrors and dispatches LOADINGACTION(false)', fakeAsync(() => {
  // arrange
  const errorResp = { error: { statusMessage: 'server failed', statusCode: '500' } };
  spyOn((component as any).feeApiservice, 'getRequest').and.returnValue(throwError(() => errorResp));
  spyOn(component, 'displayServiceErrors');
  const storeSpy = spyOn((component as any).store, 'dispatch');

  // ensure regionComboBox exists (component sets its options in complete branch)
  component['regionComboBox'] = { options: null };
  component['loading'] = true;

  // act
  component['LoadDefaultComboBox']();
  tick();

  // assert
  expect(component.displayServiceErrors).toHaveBeenCalledWith('server failed');
  expect(storeSpy).toHaveBeenCalledWith(jasmine.any(Object)); // LOADINGACTION(false)
  expect(component.loading).toBeFalse();
}));

// complete branch
it('LoadDefaultComboBox(): complete -> sets regionComboBox.options and regionComboBoxData and dispatches LOADINGACTION(false)', fakeAsync(() => {
  // arrange
  const regions = [{ regionId: 1, regionDescription: 'R1' }, { regionId: 2, regionDescription: 'R2' }];
  // feeApiservice.getRequest returns observable of regions (forkJoin expects an observable for "regions" key)
  spyOn((component as any).feeApiservice, 'getRequest').and.returnValue(of(regions));

  // make sure utils.LoadComboBoxData exists and returns expected data
  component['utils'] = { LoadComboBoxData: jasmine.createSpy('LoadComboBoxData').and.returnValue([{ value: 1, label: 'R1' }]) };
  component['regionComboBox'] = { options: null };
  const storeSpy = spyOn((component as any).store, 'dispatch');

  // act
  component['LoadDefaultComboBox']();
  tick();

  // assert
  // regions property should be set
  expect(component['regions']).toEqual(regions);
  // regionComboBoxData created from utils.LoadComboBoxData
  expect(component['regionComboBoxData']).toEqual([{ options: [{ value: 1, label: 'R1' }] }]);
  // regionComboBox.options is JSON.parse(JSON.stringify(this.regions)) in code
  expect(component['regionComboBox'].options).toEqual(JSON.parse(JSON.stringify(regions)));
  expect(storeSpy).toHaveBeenCalledWith(jasmine.any(Object)); // LOADINGACTION(false)
  expect(component.loading).toBeFalse();
}));