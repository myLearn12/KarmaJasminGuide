it('validateWorksheet(): should flag invalid misc amount when value is non-numeric', () => {
  // Arrange
  component.miscAmountColumnHeader = 'Amount';
  spyOn(component, 'checkSpreadsheetHeaders').and.callFake(() => {}); // skip header validation
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{ Amount: 'abc' }]; // invalid (non-numeric)

  // Act
  component.validateWorksheet(worksheet);

  // Assert
  expect(component.isInvalidCharLength).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'Amount field input must be a numeric value; please update and reupload..'
  );
});

it('validateWorksheet(): should flag missing misc amount column as required', () => {
  // Arrange
  component.miscAmountColumnHeader = 'Amount';
  component.isMissingRequiredField = false;
  spyOn(component, 'checkSpreadsheetHeaders').and.callFake(() => {});
  component.fileuploadError = jasmine.createSpy('fileuploadError');

  const worksheet = [{}]; // missing "Amount" key

  // Act
  component.validateWorksheet(worksheet);

  // Assert
  expect(component.isMissingRequiredField).toBeTrue();
  expect(component.fileuploadError).toHaveBeenCalledWith(
    'Amount is missing on the excel sheet. This is a required field; please update and reupload.'
  );
});