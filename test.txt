it('InitialDataLoad(): complete branch -> prepares combo data and dispatches LOADINGACTION(false)', fakeAsync(() => {
  // make sure regionid matches what the code compares (it does x.regionId.toString() === this.regionid)
  component.regionid = '10';

  // --- minimal mock data used in the complete branch (must include regionDescription) ---
  const mockRegions = [
    { regionId: 10, regionDescription: 'Region 10' },
    { regionId: 20, regionDescription: 'Region 20' }
  ];
  const mockRegionDivisions = [
    { regionId: 10, divisionDesc: 'Div A', divisionCd: 'DA', divisionId: 101 },
    { regionId: 20, divisionDesc: 'Div B', divisionCd: 'DB', divisionId: 201 }
  ];
  const mockDivisions = [{ divisionId: 101, divisionDesc: 'Div A' }];
  const mockCycles = [];
  const mockFormulas = [];
  const mockCategories = [];
  const mockOfficers = [{ officer: 'O1', officerSort: 'O1' }];
  const mockRevShare = [];

  // spy feeApiService.getRequest to return appropriate mocks by detecting URL substring
  spyOn(component['feeApiService'], 'getRequest').and.callFake((url: string) => {
    if (!url) { return of([]); }
    if (url.indexOf('getAllRegion') >= 0) return of(mockRegions);
    if (url.indexOf('getAllRegDivMapping') >= 0) return of(mockRegionDivisions);
    if (url.indexOf('getAllDivision') >= 0) return of(mockDivisions);
    if (url.indexOf('getAllCycle') >= 0) return of(mockCycles);
    if (url.indexOf('getAllFormula') >= 0) return of(mockFormulas);
    if (url.indexOf('getAllCategory') >= 0) return of(mockCategories);
    if (url.indexOf('getAllAccrualOfficer') >= 0) return of(mockOfficers);
    if (url.indexOf('getAllRevShareDivMapping') >= 0) return of(mockRevShare);
    return of([]); // fallback
  });

  // utils.LoadComboBoxData is used to build combo data in complete block - stub it
  spyOn(component['utils'], 'LoadComboBoxData').and.callFake((arr: any[], label: string, a?: any, b?: any, c?: any) => {
    // return a simplified shape the component expects (array of options)
    return arr.map(item => ({ id: item.regionId ?? item.divisionId, text: item.regionDescription ?? item.divisionDesc ?? label }));
  });

  // acctService helper used to build officer combo data
  spyOn(component['acctService'], 'LoadOfficerData').and.returnValue([{ officerSort: 'O1', officer: 'Officer One' }]);

  // watch store.dispatch
  const dispatchSpy = spyOn(component['store'], 'dispatch');

  // call method and allow async forkJoin to resolve
  component.InitialDataLoad();
  tick(); // resolve observables

  // expectations - complete branch should populate the component combos and turn loading off
  expect(component.regionDivisions).toBeDefined();
  expect(component.regionDivisions.filter((x: any) => x.regionId.toString() === component.regionid.toString()).length).toBeGreaterThan(0);

  expect(component.cbDivisionData).toBeDefined();
  expect(component.cbDivisionData.length).toBeGreaterThan(0);

  // acctService LoadOfficerData should have been used to populate officer combo data
  expect(component['acctService'].LoadOfficerData).toHaveBeenCalled();

  // store.dispatch should be called to toggle LOADINGACTION(false) in complete block
  expect(dispatchSpy).toHaveBeenCalledWith(jasmine.any(Object));

  // final flag checks
  expect(component.loading).toBeFalse();
}));