it('onSaveClick(): sets flags, dispatches LOADINGACTION(true) and handles next+complete', () => {
  // allow onSaveClick to run past the validation gates
  spyOn(component, 'ValidateFormControls').and.returnValue(false);
  spyOn(component, 'validateDates').and.returnValue(false);
  spyOn(component, 'validateFormData').and.returnValue(false);

  // minimal combo control stubs (these are used with .value.toString() inside payload)
  component.cbCategory = { value: '1' } as any;
  component.cbCycle    = { value: '1' } as any;
  component.cbFormula  = { value: '1' } as any;
  component.cbAltDivision = { value: null } as any;
  component.cbStatus   = { value: '1' } as any;
  component.cbOfficer  = { value: 'OFF1' } as any;

  // minimal account object (only fields referenced before/inside API call)
  component.account = {
    accountNbr: 'ACC001',
    acceptfee: '0',
    estacc: '0',
    actpp: '0',
    cashpp: '0',
    endpp: '0',
    feepp: '0',
    revshare: null,
    longacctnum: null,
    pcanumber: null,
    futureuse: null,
    ozId: null,
    disposition1: null,
    disposition2: null,
    disposition3: null
  } as any;

  // utils stubs used while building payload
  spyOn(component['utils'], 'getFormattedDecimal').and.callFake((v:any) => v);
  spyOn(component['utils'], 'getValidString').and.callFake((v:any) => v ?? '');
  spyOn(component['utils'], 'getCurrentUser').and.returnValue('TEST_USER');
  spyOn(component['utils'], 'ToEstDate').and.returnValue('2025-01-01T00:00:00Z');
  spyOn(component['utils'], 'getDateAndDefaultTime').and.callFake((d:any) => d ?? null);

  // spies for side-effects
  spyOn(component.store, 'dispatch').and.stub();
  const logSpy = spyOn(component, 'logAccountAudit').and.stub();

  // make feeApiservice.postRequest emit next() and complete() (successful path)
  spyOn(component['feeApiservice'], 'postRequest').and.returnValue(of({}) as any);

  // initial state assertions (optional)
  component.disableSavebtn = false;
  component.loading = false;

  // call method under test
  component.onSaveClick();

  // After a successful observable (of({})) the subscription's next and complete run synchronously,
  // so we can assert immediately.
  expect(component.errorBlockMessage).toBeNull();
  expect(component.disableSavebtn).toBeTrue(); // set before request
  expect(component.loading).toBeFalse(); // should be reset by complete
  expect(component.store.dispatch).toHaveBeenCalled(); // LOADINGACTION(true) dispatched at start
  // assert LOADINGACTION was dispatched at least once (works if LOADINGACTION is exported in spec)
  expect(component.store.dispatch).toHaveBeenCalledWith(jasmine.any(Object)); // loose check
  // ensure complete handler ran
  expect(logSpy).toHaveBeenCalled();
});