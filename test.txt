it('uploadXcelFile(): should return early when ValidateFormControls() is true', () => {
  spyOn(component, 'ValidateFormControls').and.returnValue(true);
  spyOn(component, 'processRecord');
  spyOn(component['_confirmModal'], 'show');

  component.uploadXcelFile();

  expect(component.ValidateFormControls).toHaveBeenCalled();
  expect(component.processRecord).not.toHaveBeenCalled();
  expect(component._confirmModal.show).not.toHaveBeenCalled();
});

it('uploadXcelFile(): when selected date is today should set actionMessage and show confirm modal', () => {
  spyOn(component, 'ValidateFormControls').and.returnValue(false);
  spyOn(component['utils'], 'isTodaysDate').and.returnValue(true);
  spyOn(component, 'processRecord');
  spyOn(component['_confirmModal'], 'show');

  component.uploadXcelFile();

  expect(component['utils'].isTodaysDate).toHaveBeenCalledWith(component.selectedMonthEndDate);
  expect(component.actionMessage).toBe("Date selected is Today's Date. Choose OK to continue or cancel to re-enter.");
  expect(component._confirmModal.show).toHaveBeenCalled();
  expect(component.processRecord).not.toHaveBeenCalled();
});

it('uploadXcelFile(): when selected date is not today should call processRecord()', () => {
  spyOn(component, 'ValidateFormControls').and.returnValue(false);
  spyOn(component['utils'], 'isTodaysDate').and.returnValue(false);
  const procSpy = spyOn(component, 'processRecord');

  component.uploadXcelFile();

  expect(component['utils'].isTodaysDate).toHaveBeenCalledWith(component.selectedMonthEndDate);
  expect(procSpy).toHaveBeenCalled();
});