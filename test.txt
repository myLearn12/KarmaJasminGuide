it('LoadRegion() - success: calls API, calls LoadRegionData, clears loading and dispatches LOADINGACTION(false)', () => {
  // arrange
  const cfg = { getRegionByIdUrl: '/api/region/' } as any;
  (component as any).appConfigService = cfg;
  (component as any).regionid = 'R001';

  const mockRegionResponse = { regionId: 'R001', regionDescription: 'North' };
  const feeApi = TestBed.inject(FeeApiService) as any;
  spyOn(feeApi, 'getRequest').and.returnValue(of(mockRegionResponse));

  // spy on the protected method (call via any) so we can verify it was invoked with the API response
  spyOn(component as any, 'LoadRegionData').and.callThrough();

  const store = TestBed.inject(Store) as any;
  spyOn(store, 'dispatch').and.callFake(() => {});

  // act
  (component as any).LoadRegion();

  // assert
  expect(feeApi.getRequest).toHaveBeenCalledWith('/api/region/' + 'R001');
  expect((component as any).LoadRegionData).toHaveBeenCalledWith(mockRegionResponse);
  expect((component as any).loading).toBeFalse();
  expect(store.dispatch).toHaveBeenCalled(); // dispatched LOADINGACTION(false)
});

it('LoadRegion() - error: when API errors should call displayServiceErrors and clear loading and dispatch LOADINGACTION(false)', () => {
  // arrange
  const cfg = { getRegionByIdUrl: '/api/region/' } as any;
  (component as any).appConfigService = cfg;
  (component as any).regionid = 'R002';

  const feeApi = TestBed.inject(FeeApiService) as any;
  const serverError = { error: { statusMessage: 'server failed' } };
  spyOn(feeApi, 'getRequest').and.returnValue(throwError(serverError));

  // spy displayServiceErrors to assert it was called with the server message
  spyOn(component as any, 'displayServiceErrors').and.callThrough();

  const store = TestBed.inject(Store) as any;
  spyOn(store, 'dispatch').and.callFake(() => {});

  // act
  (component as any).LoadRegion();

  // assert
  expect(feeApi.getRequest).toHaveBeenCalledWith('/api/region/' + 'R002');
  expect((component as any).displayServiceErrors).toHaveBeenCalledWith('server failed');
  expect((component as any).loading).toBeFalse();
  expect(store.dispatch).toHaveBeenCalled(); // dispatched LOADINGACTION(false)
});